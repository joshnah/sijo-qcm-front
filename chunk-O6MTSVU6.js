import{a as m}from"./chunk-Y3VK6ECA.js";import{a as h}from"./chunk-HFUMLTSQ.js";import{b as p,i as u}from"./chunk-PFJV3CQX.js";import{L as n,Pa as l,U as a,Ub as c,Y as i,ca as o}from"./chunk-DDZ2KP6O.js";var s=class e{getUser(){return window.localStorage.user?JSON.parse(window.localStorage.user):null}saveUser(r){window.localStorage.user=JSON.stringify(r)}destroyUser(){window.localStorage.removeItem("user")}static \u0275fac=function(t){return new(t||e)};static \u0275prov=i({token:e,factory:e.\u0275fac,providedIn:"root"})};var f=class e{http=o(p);jwtService=o(s);router=o(u);alertService=o(m);isAuthenticated=c(()=>!!this.userSignal());spinner=o(h);userSignal=l(null);user=this.userSignal.asReadonly();constructor(){this.setUserFromLocalStorage()}login(r){return this.spinner.openGlobalSpinner(),this.http.post("/auth/signin",r).pipe(n(()=>{this.spinner.closeGlobalSpinner()}),a(t=>{this.setAuth({token:t.token,login:r.login,role:t.role})}))}register(r){return this.http.post("/auth/signup",r)}purgeAuth(){this.jwtService.destroyUser(),this.userSignal.set(null)}setAuth(r){this.jwtService.saveUser(r),this.userSignal.set(r)}logout(){this.purgeAuth(),this.router.navigate(["/"])}hasTutorAccess(){return this.user()?.role==="ADMIN"||this.user()?.role==="TUTOR"}setUserFromLocalStorage(){let r=this.jwtService.getUser();r&&this.setAuth(r)}static \u0275fac=function(t){return new(t||e)};static \u0275prov=i({token:e,factory:e.\u0275fac,providedIn:"root"})};export{s as a,f as b};
