import{e as M,f as O}from"./chunk-J6LHC7GC.js";import"./chunk-5HBXLC4D.js";import{a as h}from"./chunk-73VRFJMX.js";import{f as I,h as D}from"./chunk-ICYQ7GPO.js";import{$ as c,$a as o,Da as l,Ma as f,Ob as E,Ra as k,Va as C,Ya as F,Za as v,_a as x,ab as r,ba as u,bb as Q,cb as w,db as m,eb as p,hb as z,ja as q,ka as S,nb as s,pb as b,rb as T,ta as y,tb as d}from"./chunk-A7BKTUOQ.js";var _=class i{modal=c(M);static \u0275fac=function(e){return new(e||i)};static \u0275cmp=u({type:i,selectors:[["app-finish-confirmation"]],standalone:!0,features:[d],decls:17,vars:0,consts:[[1,"modal-header"],["id","modal-title",1,"modal-title"],["type","button","aria-describedby","modal-title",1,"btn-close",3,"click"],[1,"modal-body"],[1,"text-danger"],[1,"modal-footer"],["type","button",1,"btn","btn-outline-secondary",3,"click"],["type","button",1,"btn","btn-danger",3,"click"]],template:function(e,n){e&1&&(o(0,"div",0)(1,"h4",1),s(2,"Finish quiz"),r(),o(3,"button",2),m("click",function(){return n.modal.dismiss("Cross click")}),r()(),o(4,"div",3)(5,"p")(6,"strong"),s(7,"Are you sure you want to finish the quiz?"),r()(),o(8,"p"),s(9," This quiz will be closed and you will be no longer able to modify responses "),o(10,"span",4),s(11,"This operation can not be undone."),r()()(),o(12,"div",5)(13,"button",6),m("click",function(){return n.modal.dismiss("cancel click")}),s(14,"Return to quiz"),r(),o(15,"button",7),m("click",function(){return n.modal.close("Ok click")}),s(16,"Finish quiz"),r()())}})};var N=(i,t)=>t.id;function V(i,t){if(i&1){let e=w();T(0),o(1,"div",7)(2,"input",8),m("change",function(){let a=q(e).$implicit,A=p().$implicit,j=p();return S(j.selectAnswer(A.id,a.id))}),r(),o(3,"label",9),s(4),r()()}if(i&2){let e=t.$implicit,n=p().$implicit,a=p().selectedResponses()[n.id].has(e.id);l(2),z("id","",n.id,"-",e.id,""),C("checked",a),l(),z("for","",n.id,"-",e.id,""),l(),b(" ",e.option," ")}}function L(i,t){if(i&1&&(o(0,"h3"),s(1),r(),o(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5),s(6),r(),o(7,"form",6),v(8,V,5,8,"div",7,N),r()()()()),i&2){let e=t.$implicit,n=t.$index;l(),b("Question ",n,""),l(5),b(" ",e.text," "),l(2),x(e.answers)}}var g=class i{quiz=y.required();modalService=c(O);quizService=c(h);router=c(D);selectedResponses=f({});ngOnInit(){let t={};this.quiz().questions.forEach(e=>{t[e.id]=new Set}),this.selectedResponses.set(t)}selectAnswer(t,e){this.selectedResponses.update(n=>{let a=n[t];return a.has(e)?a.delete(e):a.add(e),n})}openFinishConfirmationPopup(){this.modalService.open(_).closed.subscribe(()=>{this.submit()})}submit(){this.quizService.submit(this.selectedResponses(),this.quiz()._id).subscribe(t=>{this.router.navigate([`/submissions/${t.submissionId}`])})}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=u({type:i,selectors:[["app-questions-container"]],inputs:{quiz:[1,"quiz"]},standalone:!0,features:[d],decls:5,vars:0,consts:[[1,"d-flex","justify-content-center","mt-4"],[1,"btn","btn-danger",3,"click"],[1,"container","mt-4"],[1,"card","shadow","p-3","mb-4"],[1,"card-body"],[1,"card-title","border","rounded","p-3",2,"white-space","pre-wrap","max-height","500px","overflow-y","auto"],[1,"d-flex","flex-column","gap-3"],[1,"btn-group"],["type","checkbox",1,"btn-check",3,"change","checked","id"],[1,"btn","btn-lg","text-start","btn-outline-primary",3,"for"]],template:function(e,n){e&1&&(v(0,L,10,2,null,null,N),o(2,"div",0)(3,"button",1),m("click",function(){return n.openFinishConfirmationPopup()}),s(4," Finish test "),r()()),e&2&&x(n.quiz().questions)},styles:[".btn-check[_ngcontent-%COMP%]:disabled + label[_ngcontent-%COMP%]{opacity:1}.wrong-icon[_ngcontent-%COMP%]{color:red;margin-left:10px;font-size:1.5rem;vertical-align:middle}"],changeDetection:0})};function W(i,t){if(i&1&&(o(0,"div",0),Q(1,"app-questions-container",2),r()),i&2){let e=p();l(),C("quiz",e.quiz)}}function B(i,t){i&1&&(o(0,"div",1)(1,"span",3),s(2,"Loading..."),r()())}var P=class i{route=c(I);loading=f(!0);haveStarted=!1;quiz;quizService=c(h);ngOnInit(){let t=this.route.snapshot.paramMap.get("id");t&&this.quizService.fetchQuiz(t).subscribe(e=>{this.quiz=e,this.loading.set(!1)})}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=u({type:i,selectors:[["app-quiz-taker"]],standalone:!0,features:[d],decls:2,vars:1,consts:[[1,"d-flex","justify-content-center","align-items-center","container","flex-column","gap-3"],["role","status",1,"spinner-border","text-primary"],[3,"quiz"],[1,"visually-hidden"]],template:function(e,n){e&1&&k(0,W,2,1,"div",0)(1,B,3,0,"div",1),e&2&&F(n.loading()?1:0)},dependencies:[E,g],changeDetection:0})};export{P as QuizTakerComponent};
