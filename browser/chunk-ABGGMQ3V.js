import{a as K}from"./chunk-5SAHMNYK.js";import{a as O}from"./chunk-SXTHDFRF.js";import{h as j,i as L,j as P,k as D,l as $,n as R,o as H,p as G}from"./chunk-4DZUVPES.js";import{b as W,c as I,d as J,g as A,j as B}from"./chunk-E6KXUOZS.js";import{a as F}from"./chunk-4XXAIRCU.js";import{f as V,h as T}from"./chunk-L4DC4MBR.js";import{Bb as g,Cb as C,Db as x,Ia as u,Pa as v,Sa as q,Xa as f,bb as z,c as Q,ca as h,eb as b,gb as E,hb as S,ib as a,ja as d,jb as r,ka as _,kb as M,lb as p,nb as m,ob as c,rb as y,wb as N,xb as l,zb as k}from"./chunk-PU24A2QT.js";var U={_id:"%s",title:"This is an example",explanation:"Example",category:"Java",questions:[{id:"q1",text:"Quel est le type de retour de la m\xE9thode 'main' en Java ?",answers:[{id:"a1",option:"void",isCorrect:!0},{id:"a2",option:"int",isCorrect:!0},{id:"a3",option:"String"},{id:"a4",option:"boolean"}]}]};var Y=(s,i)=>i.id;function Z(s,i){if(s&1){let e=p();a(0,"div",2)(1,"h3",3),l(2,"Edit Quiz"),r(),a(3,"div")(4,"button",4),m("click",function(){d(e);let t=c();return _(t.reset())}),l(5,"Reset"),r()()()}}function ee(s,i){s&1&&(a(0,"h3"),l(1,"Create new quiz"),r())}function te(s,i){if(s&1){let e=p();a(0,"div",20)(1,"input",23),x("ngModelChange",function(t){let n=d(e).$implicit;return C(n.option,t)||(n.option=t),_(t)}),r(),a(2,"div",24)(3,"input",25),x("ngModelChange",function(t){let n=d(e).$implicit;return C(n.isCorrect,t)||(n.isCorrect=t),_(t)}),r(),a(4,"label",26),l(5," Is correct? "),r()(),a(6,"button",22),m("click",function(){let t=d(e).$index,n=c().$index,w=c(3);return _(w.deleteAnswer(n,t))}),l(7," Delete Answer "),r()()}if(s&2){let e=i.$implicit,o=i.$index,t=c().$index;u(),g("ngModel",e.option),u(2),y("id","correctAnswer",t,"-",o,""),g("ngModel",e.isCorrect),u(),y("for","correctAnswer",t,"-",o,"")}}function ie(s,i){if(s&1){let e=p();a(0,"div",15)(1,"label"),l(2),r(),a(3,"input",19),x("ngModelChange",function(t){let n=d(e).$implicit;return C(n.text,t)||(n.text=t),_(t)}),r(),E(4,te,8,8,"div",20,Y),a(6,"button",21),m("click",function(){let t=d(e).$index,n=c(3);return _(n.addAnswer(t))}),l(7," Add Answer "),r(),a(8,"button",22),m("click",function(){let t=d(e).$index,n=c(3);return _(n.deleteQuestion(t))}),l(9," Delete Question "),r()()}if(s&2){let e=i.$implicit,o=i.$index;u(2),k("Question ",o+1,""),u(),g("ngModel",e.text),u(),S(e.answers)}}function ne(s,i){if(s&1){let e=p();a(0,"button",27),m("click",function(){d(e);let t=c(3);return _(t.delete())}),l(1," Delete Quiz "),r(),a(2,"button",28),m("click",function(){d(e);let t=c(3);return _(t.save())}),l(3,"Save"),r()}}function oe(s,i){if(s&1){let e=p();a(0,"button",28),m("click",function(){d(e);let t=c(3);return _(t.create())}),l(1," Create quiz "),r()}}function re(s,i){if(s&1){let e=p();a(0,"div")(1,"div",10)(2,"label",11),l(3,"Title"),r(),a(4,"input",12),x("ngModelChange",function(t){d(e);let n=c(2);return C(n.quiz().title,t)||(n.quiz().title=t),_(t)}),r()(),a(5,"div",10)(6,"label",11),l(7,"Explanation"),r(),a(8,"textarea",13),x("ngModelChange",function(t){d(e);let n=c(2);return C(n.quiz().explanation,t)||(n.quiz().explanation=t),_(t)}),r()(),a(9,"div",10)(10,"label",11),l(11,"Category"),r(),a(12,"input",14),x("ngModelChange",function(t){d(e);let n=c(2);return C(n.quiz().category,t)||(n.quiz().category=t),_(t)}),r()()(),a(13,"h4"),l(14,"Questions"),r(),E(15,ie,10,2,"div",15,Y),a(17,"button",16),m("click",function(){d(e);let t=c(2);return _(t.addQuestion())}),l(18," Add Question "),r(),a(19,"div",17),f(20,ne,4,0)(21,oe,2,0,"button",18),r()}if(s&2){let e=c(2);u(4),g("ngModel",e.quiz().title),u(4),g("ngModel",e.quiz().explanation),u(4),g("ngModel",e.quiz().category),u(3),S(e.quiz().questions),u(5),b(e.isEditing?20:21)}}function ae(s,i){if(s&1){let e=p();a(0,"div",29)(1,"ngx-monaco-editor",30),x("ngModelChange",function(t){d(e);let n=c(2);return C(n.jsonQuiz,t)||(n.jsonQuiz=t),_(t)}),r()(),a(2,"button",31),m("click",function(){d(e);let t=c(2);return _(t.checkJson())}),l(3," Check JSON "),r()}if(s&2){let e=c(2);u(),g("ngModel",e.jsonQuiz),z("options",e.editorOptions)}}function se(s,i){if(s&1){let e=p();a(0,"ul",5,0),m("navChange",function(t){d(e);let n=c();return _(n.onTabChange(t))}),a(2,"li",6)(3,"a",7),l(4,"Form Input"),r(),f(5,re,22,4,"ng-template",8),r(),a(6,"li",6)(7,"a",7),l(8,"JSON Editor"),r(),f(9,ae,4,2,"ng-template",8),r()(),M(10,"div",9)}if(s&2){let e=N(1);u(2),z("ngbNavItem",1),u(4),z("ngbNavItem",2),u(4),z("ngbNavOutlet",e)}}var X=class s{route=h(V);router=h(T);quizService=h(F);alertService=h(O);quiz=v(null);jsonQuiz=v("");quizBase;editorOptions={language:"json",scrollBeyondLastLine:!1,lineHeight:20,fontSize:14,wordWrap:"on",wrappingIndent:"indent",theme:"customTheme",automaticLayout:!0};ngOnInit(){let i=this.route.snapshot.paramMap.get("id");if(i)this.fetchQuiz(i);else{let e=JSON.parse(JSON.stringify(U)),{_id:o}=e,t=Q(e,["_id"]);this.quiz.set(t)}}save(){this.quiz()&&this.quizService.updateQuiz(this.quiz()).subscribe({next:i=>{this.quiz.set(i),this.alertService.setMessage({message:"Quiz has been updated",type:"success"})},error:i=>{this.alertService.setMessage({message:`Error while updating quiz:  ${i?.description}`,type:"danger"})}})}reset(){this.quizBase&&(this.quiz.set(JSON.parse(JSON.stringify(this.quizBase))),this.jsonQuiz.set(JSON.stringify(this.quizBase,null,2)))}delete(){this.quizService.deleteQuiz(this.quiz()).subscribe(()=>{this.router.navigate(["/quizzes"]),this.alertService.setMessage({message:"Quiz has been deleted",type:"success"})})}create(){this.quizService.createQuiz(this.quiz()).subscribe(()=>{this.router.navigate(["/quizzes"]),this.alertService.setMessage({message:"Quiz has been created",type:"success"})})}fetchQuiz(i){this.quizService.fetchFullQuizById(i).subscribe(e=>{e&&(this.quizBase=JSON.parse(JSON.stringify(e)),this.quiz.set(JSON.parse(JSON.stringify(e))),this.jsonQuiz.set(JSON.stringify(this.quiz(),null,2)))})}checkJson(){try{this.quiz.set(JSON.parse(this.jsonQuiz()))}catch{return this.alertService.setMessage({message:"Invalid JSON format. Please correct it.",type:"danger"}),!1}return!0}addQuestion(){this.quiz.update(i=>{let e=`q${(i?.questions.length||0)+1}`;return i?.questions.push({id:e,text:"Text sample",answers:[{id:"a1",option:"option 1",isCorrect:!0},{id:"a2",option:"option 2"},{id:"a3",option:"option 3"}]}),i})}addAnswer(i){this.quiz.update(e=>(e?.questions[i].answers.push({id:`a${e?.questions[i].answers.length+1}`,option:"new option"}),e))}deleteAnswer(i,e){this.quiz.update(o=>{let t=o?.questions[i].answers;return t?.splice(e,1),t?.forEach((n,w)=>{n.id=`a${w+1}`}),o})}deleteQuestion(i){this.quiz.update(e=>{let o=e?.questions;return o?.splice(i,1),o?.forEach((t,n)=>{t.id=`q${n+1}`}),e})}onTabChange(i){i.nextId===1&&!this.checkJson()?i.preventDefault():this.jsonQuiz.set(JSON.stringify(this.quiz(),null,2))}get isEditing(){return!!this.route.snapshot.paramMap.get("id")}static \u0275fac=function(e){return new(e||s)};static \u0275cmp=q({type:s,selectors:[["app-quiz-edit"]],decls:4,vars:2,consts:[["nav","ngbNav"],[1,"container","mt-3"],[1,"d-flex","justify-content-between","align-items-center","mb-3"],[1,"m-0"],[1,"btn","btn-primary",3,"click"],["ngbNav","",1,"nav","nav-tabs",3,"navChange"],[3,"ngbNavItem"],["ngbNavLink",""],["ngbNavContent",""],[1,"mt-3",3,"ngbNavOutlet"],[1,"mb-2"],[1,"form-label"],["type","text","placeholder","Enter Quiz Title",1,"form-control",3,"ngModelChange","ngModel"],["rows","3","placeholder","Enter Explanation",1,"form-control",3,"ngModelChange","ngModel"],["type","text","placeholder","Enter Category",1,"form-control",3,"ngModelChange","ngModel"],[1,"border","p-3","mb-3"],[1,"btn","btn-sm","btn-success",3,"click"],[1,"d-flex","justify-content-end","mt-4"],[1,"btn","btn-success"],["type","text","placeholder","Enter Question Text",1,"form-control","mb-2",3,"ngModelChange","ngModel"],[1,"input-group","mb-2","align-items-center"],[1,"btn","btn-sm","btn-outline-primary",3,"click"],[1,"btn","btn-sm","btn-outline-danger","ms-2",3,"click"],["type","text","placeholder","Enter Answer Option",1,"form-control",3,"ngModelChange","ngModel"],[1,"form-check","ms-3","d-flex"],["type","checkbox",1,"form-check-input","larger-checkbox",3,"ngModelChange","id","ngModel"],[1,"form-check-label",3,"for"],[1,"btn","btn-outline-danger","me-2",3,"click"],[1,"btn","btn-success",3,"click"],[1,"editor-container"],["aria-label","JSON Quiz Editor",1,"json-editor",3,"ngModelChange","ngModel","options"],[1,"mt-3","btn","btn-primary",3,"click"]],template:function(e,o){e&1&&(a(0,"div",1),f(1,Z,6,0,"div",2)(2,ee,2,0,"h3")(3,se,11,3),r()),e&2&&(u(),b(o.isEditing?1:2),u(2),b(o.quiz()?3:-1))},dependencies:[B,I,W,J,A,G,j,D,P,L,R,$,H,K],styles:[".editor-container[_ngcontent-%COMP%]{height:calc(100vh - 300px)}.json-editor[_ngcontent-%COMP%]{height:100%;width:100%;display:block}.larger-checkbox[_ngcontent-%COMP%]{width:1.5em;height:1.5em;margin-right:.5em;cursor:pointer}.form-check-label[_ngcontent-%COMP%]{font-size:1rem;margin-left:.2em;cursor:pointer}"],changeDetection:0})};export{X as QuizEditComponent};
