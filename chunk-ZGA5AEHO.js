import{a as re}from"./chunk-Y3YM4HJZ.js";import{a as oe}from"./chunk-RPDYWJNU.js";import{a as ne}from"./chunk-LCPV2XUX.js";import{a as P}from"./chunk-Y3VK6ECA.js";import{a as ie}from"./chunk-HFUMLTSQ.js";import{A as M,H,I as K,J as U,K as X,L as Y,N as Z,O as ee,P as te,g as B,i as D,p as L,q as j,r as Q,s as $,t as R,u as q,v as G}from"./chunk-PFJV3CQX.js";import{Bb as A,Db as g,Eb as C,Fb as f,Ia as u,L as I,Pa as k,Qa as W,Ta as S,Vb as J,Ya as h,a as z,ca as x,cb as b,fb as w,ib as T,ja as m,jb as V,ka as d,kb as a,lb as r,mb as y,nb as _,pb as p,qb as c,tb as F,va as O,yb as E,zb as l}from"./chunk-DDZ2KP6O.js";var ae={_id:"%s",title:"This is an example",explanation:"Example",category:"Java",questions:[{id:"q1",text:"Quel est le type de retour de la m\xE9thode 'main' en Java ?",answers:[{id:"a1",option:"void",isCorrect:!0},{id:"a2",option:"int",isCorrect:!0},{id:"a3",option:"String"},{id:"a4",option:"boolean"}]}]};var se=(s,i)=>i.id;function de(s,i){if(s&1){let e=_();a(0,"div",8)(1,"input",11),f("ngModelChange",function(t){let o=m(e).$implicit;return C(o.option,t)||(o.option=t),d(t)}),r(),a(2,"div",12)(3,"input",13),f("ngModelChange",function(t){let o=m(e).$implicit;return C(o.isCorrect,t)||(o.isCorrect=t),d(t)}),r(),a(4,"label",14),l(5," Is correct? "),r()(),a(6,"button",10),p("click",function(){let t=m(e).$index,o=c().$index,v=c();return d(v.deleteAnswer(o,t))}),l(7," Delete Answer "),r()()}if(s&2){let e=i.$implicit,n=i.$index,t=c().$index;u(),g("ngModel",e.option),u(2),F("id","correctAnswer",t,"-",n,""),g("ngModel",e.isCorrect),u(),F("for","correctAnswer",t,"-",n,"")}}function pe(s,i){if(s&1){let e=_();a(0,"div",5)(1,"label"),l(2),r(),a(3,"input",7),f("ngModelChange",function(t){let o=m(e).$implicit;return C(o.text,t)||(o.text=t),d(t)}),r(),T(4,de,8,8,"div",8,se),a(6,"button",9),p("click",function(){let t=m(e).$index,o=c();return d(o.addAnswer(t))}),l(7," Add Answer "),r(),a(8,"button",10),p("click",function(){let t=m(e).$index,o=c();return d(o.deleteQuestion(t))}),l(9," Delete Question "),r()()}if(s&2){let e=i.$implicit,n=i.$index;u(2),A("Question ",n+1,""),u(),g("ngModel",e.text),u(),V(e.answers)}}var N=class s{quiz=W.required();isEditing=O(!1);addQuestion(){this.quiz.update(i=>{let e=`q${(i?.questions.length||0)+1}`;return i?.questions.push({id:e,text:"Text sample",answers:[{id:"a1",option:"option 1",isCorrect:!0},{id:"a2",option:"option 2"},{id:"a3",option:"option 3"}]}),z({},i)})}addAnswer(i){this.quiz.update(e=>(e?.questions[i].answers.push({id:`a${e?.questions[i].answers.length+1}`,option:"new option"}),z({},e)))}deleteAnswer(i,e){this.quiz.update(n=>{let t=n?.questions[i].answers;return t?.splice(e,1),t?.forEach((o,v)=>{o.id=`a${v+1}`}),z({},n)})}deleteQuestion(i){this.quiz.update(e=>{let n=e?.questions;return n?.splice(i,1),n?.forEach((t,o)=>{t.id=`q${o+1}`}),z({},e)})}static \u0275fac=function(e){return new(e||s)};static \u0275cmp=S({type:s,selectors:[["app-quiz-form"]],inputs:{quiz:[1,"quiz"],isEditing:[1,"isEditing"]},outputs:{quiz:"quizChange"},decls:19,vars:3,consts:[[1,"mb-2"],[1,"form-label"],["type","text","placeholder","Enter Quiz Title",1,"form-control",3,"ngModelChange","ngModel"],["rows","3","placeholder","Enter Explanation",1,"form-control",3,"ngModelChange","ngModel"],["type","text","placeholder","Enter Category",1,"form-control",3,"ngModelChange","ngModel"],[1,"border","p-3","mb-3"],[1,"btn","btn-sm","btn-success",3,"click"],["type","text","placeholder","Enter Question Text",1,"form-control","mb-2",3,"ngModelChange","ngModel"],[1,"input-group","mb-2","align-items-center"],[1,"btn","btn-sm","btn-outline-primary",3,"click"],[1,"btn","btn-sm","btn-outline-danger","ms-2",3,"click"],["type","text","placeholder","Enter Answer Option",1,"form-control",3,"ngModelChange","ngModel"],[1,"form-check","ms-3","d-flex"],["type","checkbox",1,"form-check-input","larger-checkbox",3,"ngModelChange","id","ngModel"],[1,"form-check-label",3,"for"]],template:function(e,n){e&1&&(a(0,"div")(1,"div",0)(2,"label",1),l(3,"Title"),r(),a(4,"input",2),f("ngModelChange",function(o){return C(n.quiz().title,o)||(n.quiz().title=o),o}),r()(),a(5,"div",0)(6,"label",1),l(7,"Explanation"),r(),a(8,"textarea",3),f("ngModelChange",function(o){return C(n.quiz().explanation,o)||(n.quiz().explanation=o),o}),r()(),a(9,"div",0)(10,"label",1),l(11,"Category"),r(),a(12,"input",4),f("ngModelChange",function(o){return C(n.quiz().category,o)||(n.quiz().category=o),o}),r()()(),a(13,"h4"),l(14,"Questions"),r(),T(15,pe,10,2,"div",5,se),a(17,"button",6),p("click",function(){return n.addQuestion()}),l(18,` Add Question
`),r()),e&2&&(u(4),g("ngModel",n.quiz().title),u(4),g("ngModel",n.quiz().explanation),u(4),g("ngModel",n.quiz().category),u(3),V(n.quiz().questions))},dependencies:[M,j,L,Q,q],styles:[".larger-checkbox[_ngcontent-%COMP%]{width:1.5em;height:1.5em;margin-right:.5em;cursor:pointer}.form-check-label[_ngcontent-%COMP%]{font-size:1rem;margin-left:.2em;cursor:pointer}"],changeDetection:0})};function _e(s,i){if(s&1){let e=_();a(0,"div",4)(1,"h3",5),l(2,"Edit Quiz"),r(),a(3,"div")(4,"button",6),p("click",function(){m(e);let t=c();return d(t.reset())}),l(5,"Reset"),r()()()}}function ge(s,i){s&1&&(a(0,"h3"),l(1,"Create new quiz"),r())}function Ce(s,i){if(s&1){let e=_();a(0,"button",15),p("click",function(){m(e);let t=c(3);return d(t.delete())}),l(1," Delete Quiz "),r(),a(2,"button",16),p("click",function(){m(e);let t=c(3);return d(t.save())}),l(3,"Save"),r()}}function fe(s,i){if(s&1){let e=_();a(0,"button",16),p("click",function(){m(e);let t=c(3);return d(t.create())}),l(1," Create quiz "),r()}}function ze(s,i){if(s&1){let e=_();a(0,"app-quiz-form",12),f("quizChange",function(t){m(e);let o=c(2);return C(o.quiz,t)||(o.quiz=t),d(t)}),r(),a(1,"div",13),h(2,Ce,4,0)(3,fe,2,0,"button",14),r()}if(s&2){let e=c(2);g("quiz",e.quiz),b("isEditing",e.isEditing),u(2),w(e.isEditing?2:3)}}function he(s,i){if(s&1){let e=_();a(0,"div",17)(1,"ngx-monaco-editor",18),f("ngModelChange",function(t){m(e);let o=c(2);return C(o.jsonQuiz,t)||(o.jsonQuiz=t),d(t)}),r()(),a(2,"button",19),p("click",function(){m(e);let t=c(2);return d(t.checkJson())}),l(3," Check JSON "),r()}if(s&2){let e=c(2);u(),g("ngModel",e.jsonQuiz),b("options",e.editorOptions)}}function be(s,i){if(s&1){let e=_();a(0,"form",20),p("ngSubmit",function(){m(e);let t=E(5),o=E(10),v=c(3);return d(v.generateQuiz(t.value,o.value))}),a(1,"div",21)(2,"label",22),l(3,"This quiz is about..."),r(),y(4,"input",23,1),r(),a(6,"div",21)(7,"label",24),l(8,"Number of questions"),r(),y(9,"input",25,2),r(),a(11,"button",26),l(12," Generate "),r()()}}function xe(s,i){s&1&&(a(0,"li",8)(1,"a",9),l(2,"AI generator"),r(),h(3,be,13,0,"ng-template",10),r()),s&2&&b("ngbNavItem",3)}function ve(s,i){if(s&1){let e=_();a(0,"ul",7,0),f("activeIdChange",function(t){m(e);let o=c();return C(o.active,t)||(o.active=t),d(t)}),p("navChange",function(t){m(e);let o=c();return d(o.onTabChange(t))}),a(2,"li",8)(3,"a",9),l(4,"Form Input"),r(),h(5,ze,4,3,"ng-template",10),r(),a(6,"li",8)(7,"a",9),l(8,"JSON Editor"),r(),h(9,he,4,2,"ng-template",10),r(),h(10,xe,4,1,"li",8),r(),y(11,"div",11)}if(s&2){let e=E(1),n=c();g("activeId",n.active),u(2),b("ngbNavItem",1),u(4),b("ngbNavItem",2),u(4),w(n.isEditing?-1:10),u(),b("ngbNavOutlet",e)}}var le=class s{route=x(B);router=x(D);quizService=x(ne);alertService=x(P);spinnerService=x(ie);quizBase;quiz=k(JSON.parse(JSON.stringify(ae)));active=k(1);jsonQuiz=J(()=>JSON.stringify(this.quiz(),null,2));editorOptions=re;ngOnInit(){let i=this.route.snapshot.paramMap.get("id");i&&this.fetchQuiz(i)}generateQuiz(i,e){this.spinnerService.openGlobalSpinner(),this.quizService.generateQuiz(i,e).pipe(I(()=>{this.spinnerService.closeGlobalSpinner(),this.alertService.setMessage({message:"Quiz has been generated",type:"success"})})).subscribe(n=>{this.jsonQuiz.set(JSON.stringify(n,null,2)),this.active.set(2)})}save(){this.quiz()&&this.quizService.updateQuiz(this.quiz()).subscribe({next:i=>{this.alertService.setMessage({message:"Quiz has been updated",type:"success"}),this.router.navigate(["/quizzes"])},error:i=>{this.alertService.setMessage({message:`Error while updating quiz:  ${i?.description}`,type:"danger"})}})}reset(){this.quizBase&&this.quiz.set(this.quizBase)}delete(){this.quizService.deleteQuiz(this.quiz()).subscribe(()=>{this.router.navigate(["/quizzes"]),this.alertService.setMessage({message:"Quiz has been deleted",type:"success"})})}create(){this.quizService.createQuiz(this.quiz()).subscribe(()=>{this.router.navigate(["/quizzes"]),this.quizService.fetchQuizzes(),this.alertService.setMessage({message:"Quiz has been created",type:"success"})})}fetchQuiz(i){this.quizService.fetchFullQuizById(i).subscribe(e=>{e&&(this.quizBase=JSON.parse(JSON.stringify(e)),this.quiz.set(e))})}checkJson(){try{this.quiz.set(JSON.parse(this.jsonQuiz()))}catch{return this.alertService.setMessage({message:"Invalid JSON format. Please correct it.",type:"danger"}),!1}return this.alertService.setMessage({message:"JSON is valid",type:"success"}),!0}onTabChange(i){i.nextId===1&&!this.checkJson()?i.preventDefault():i.nextId===2&&this.quiz.set(z({},this.quiz()))}get isEditing(){return!!this.route.snapshot.paramMap.get("id")}static \u0275fac=function(e){return new(e||s)};static \u0275cmp=S({type:s,selectors:[["app-quiz-edit"]],decls:4,vars:2,consts:[["nav","ngbNav"],["topics",""],["nbQuestions",""],[1,"container","mt-3"],[1,"d-flex","justify-content-between","align-items-center","mb-3"],[1,"m-0"],[1,"btn","btn-primary",3,"click"],["ngbNav","",1,"nav","nav-tabs",3,"activeIdChange","navChange","activeId"],[3,"ngbNavItem"],["ngbNavLink",""],["ngbNavContent",""],[1,"mt-3",3,"ngbNavOutlet"],[3,"quizChange","quiz","isEditing"],[1,"d-flex","justify-content-end","mt-4"],[1,"btn","btn-success"],[1,"btn","btn-outline-danger","me-2",3,"click"],[1,"btn","btn-success",3,"click"],[1,"editor-container"],["aria-label","JSON Quiz Editor",1,"json-editor",3,"ngModelChange","ngModel","options"],[1,"mt-3","btn","btn-primary",3,"click"],[3,"ngSubmit"],[1,"form-group"],["for","topics"],["type","text","id","topics","aria-describedby","topics","placeholder","Quiz topics","value","Java,Python",1,"form-control"],["for","nbQuestions"],["type","number","id","nbQuestions","placeholder","nbQuestions","value","5",1,"form-control"],["type","submit",1,"btn","btn-primary","mt-3"]],template:function(e,n){e&1&&(a(0,"div",3),h(1,_e,6,0,"div",4)(2,ge,2,0,"h3")(3,ve,12,5),r()),e&2&&(u(),w(n.isEditing?1:2),u(2),w(n.quiz()?3:-1))},dependencies:[M,G,Q,$,q,R,te,H,X,U,K,Z,Y,ee,oe,N],styles:[".editor-container[_ngcontent-%COMP%]{height:calc(100vh - 300px)}.json-editor[_ngcontent-%COMP%]{height:100%;width:100%;display:block}"],changeDetection:0})};export{le as QuizEditComponent};
