import{a as ee}from"./chunk-JRATPDQ4.js";import{a as I}from"./chunk-CVNQIEP5.js";import{a as Y}from"./chunk-2QQHY5FA.js";import{a as Z}from"./chunk-UK7DRNUM.js";import{c as W,d as J,e as A,f as B,g as F,h as j,i as P,k as L,r as D,s as $,t as G,u as R,v as H,x as K,y as U,z as X}from"./chunk-A3T46DET.js";import{g as T,i as O}from"./chunk-HB4LE65O.js";import{Bb as g,Cb as C,Db as x,Ia as _,L as M,Pa as w,Sa as V,Xa as h,bb as f,c as N,ca as b,eb as v,gb as y,hb as Q,ib as a,ja as d,jb as n,ka as u,kb as S,lb as p,nb as m,ob as c,rb as q,wb as E,xb as l,zb as k}from"./chunk-I64YHXKP.js";var te={_id:"%s",title:"This is an example",explanation:"Example",category:"Java",questions:[{id:"q1",text:"Quel est le type de retour de la m\xE9thode 'main' en Java ?",answers:[{id:"a1",option:"void",isCorrect:!0},{id:"a2",option:"int",isCorrect:!0},{id:"a3",option:"String"},{id:"a4",option:"boolean"}]}]};var ne=(s,i)=>i.id;function oe(s,i){if(s&1){let e=p();a(0,"div",4)(1,"h3",5),l(2,"Edit Quiz"),n(),a(3,"div")(4,"button",6),m("click",function(){d(e);let t=c();return u(t.reset())}),l(5,"Reset"),n()()()}}function re(s,i){s&1&&(a(0,"h3"),l(1,"Create new quiz"),n())}function ae(s,i){if(s&1){let e=p();a(0,"div",22)(1,"input",25),x("ngModelChange",function(t){let r=d(e).$implicit;return C(r.option,t)||(r.option=t),u(t)}),n(),a(2,"div",26)(3,"input",27),x("ngModelChange",function(t){let r=d(e).$implicit;return C(r.isCorrect,t)||(r.isCorrect=t),u(t)}),n(),a(4,"label",28),l(5," Is correct? "),n()(),a(6,"button",24),m("click",function(){let t=d(e).$index,r=c().$index,z=c(3);return u(z.deleteAnswer(r,t))}),l(7," Delete Answer "),n()()}if(s&2){let e=i.$implicit,o=i.$index,t=c().$index;_(),g("ngModel",e.option),_(2),q("id","correctAnswer",t,"-",o,""),g("ngModel",e.isCorrect),_(),q("for","correctAnswer",t,"-",o,"")}}function se(s,i){if(s&1){let e=p();a(0,"div",17)(1,"label"),l(2),n(),a(3,"input",21),x("ngModelChange",function(t){let r=d(e).$implicit;return C(r.text,t)||(r.text=t),u(t)}),n(),y(4,ae,8,8,"div",22,ne),a(6,"button",23),m("click",function(){let t=d(e).$index,r=c(3);return u(r.addAnswer(t))}),l(7," Add Answer "),n(),a(8,"button",24),m("click",function(){let t=d(e).$index,r=c(3);return u(r.deleteQuestion(t))}),l(9," Delete Question "),n()()}if(s&2){let e=i.$implicit,o=i.$index;_(2),k("Question ",o+1,""),_(),g("ngModel",e.text),_(),Q(e.answers)}}function le(s,i){if(s&1){let e=p();a(0,"button",29),m("click",function(){d(e);let t=c(3);return u(t.delete())}),l(1," Delete Quiz "),n(),a(2,"button",30),m("click",function(){d(e);let t=c(3);return u(t.save())}),l(3,"Save"),n()}}function ce(s,i){if(s&1){let e=p();a(0,"button",30),m("click",function(){d(e);let t=c(3);return u(t.create())}),l(1," Create quiz "),n()}}function de(s,i){if(s&1){let e=p();a(0,"div")(1,"div",12)(2,"label",13),l(3,"Title"),n(),a(4,"input",14),x("ngModelChange",function(t){d(e);let r=c(2);return C(r.quiz().title,t)||(r.quiz().title=t),u(t)}),n()(),a(5,"div",12)(6,"label",13),l(7,"Explanation"),n(),a(8,"textarea",15),x("ngModelChange",function(t){d(e);let r=c(2);return C(r.quiz().explanation,t)||(r.quiz().explanation=t),u(t)}),n()(),a(9,"div",12)(10,"label",13),l(11,"Category"),n(),a(12,"input",16),x("ngModelChange",function(t){d(e);let r=c(2);return C(r.quiz().category,t)||(r.quiz().category=t),u(t)}),n()()(),a(13,"h4"),l(14,"Questions"),n(),y(15,se,10,2,"div",17,ne),a(17,"button",18),m("click",function(){d(e);let t=c(2);return u(t.addQuestion())}),l(18," Add Question "),n(),a(19,"div",19),h(20,le,4,0)(21,ce,2,0,"button",20),n()}if(s&2){let e=c(2);_(4),g("ngModel",e.quiz().title),_(4),g("ngModel",e.quiz().explanation),_(4),g("ngModel",e.quiz().category),_(3),Q(e.quiz().questions),_(5),v(e.isEditing?20:21)}}function ue(s,i){if(s&1){let e=p();a(0,"div",31)(1,"ngx-monaco-editor",32),x("ngModelChange",function(t){d(e);let r=c(2);return C(r.jsonQuiz,t)||(r.jsonQuiz=t),u(t)}),n()(),a(2,"button",33),m("click",function(){d(e);let t=c(2);return u(t.checkJson())}),l(3," Check JSON "),n()}if(s&2){let e=c(2);_(),g("ngModel",e.jsonQuiz),f("options",e.editorOptions)}}function _e(s,i){if(s&1){let e=p();a(0,"form",34),m("ngSubmit",function(){d(e);let t=E(5),r=E(10),z=c(3);return u(z.generateQuiz(t.value,r.value))}),a(1,"div",35)(2,"label",36),l(3,"This quiz is about..."),n(),S(4,"input",37,1),n(),a(6,"div",35)(7,"label",38),l(8,"Number of questions"),n(),S(9,"input",39,2),n(),a(11,"button",40),l(12," Generate "),n()()}}function me(s,i){s&1&&(a(0,"li",8)(1,"a",9),l(2,"AI generator"),n(),h(3,_e,13,0,"ng-template",10),n()),s&2&&f("ngbNavItem",3)}function pe(s,i){if(s&1){let e=p();a(0,"ul",7,0),x("activeIdChange",function(t){d(e);let r=c();return C(r.active,t)||(r.active=t),u(t)}),m("navChange",function(t){d(e);let r=c();return u(r.onTabChange(t))}),a(2,"li",8)(3,"a",9),l(4,"Form Input"),n(),h(5,de,22,4,"ng-template",10),n(),a(6,"li",8)(7,"a",9),l(8,"JSON Editor"),n(),h(9,ue,4,2,"ng-template",10),n(),h(10,me,4,1,"li",8),n(),S(11,"div",11)}if(s&2){let e=E(1),o=c();g("activeId",o.active),_(2),f("ngbNavItem",1),_(4),f("ngbNavItem",2),_(4),v(o.isEditing?-1:10),_(),f("ngbNavOutlet",e)}}var ie=class s{route=b(T);router=b(O);quizService=b(Z);alertService=b(I);spinnerService=b(Y);quizBase;active=w(1);quiz=w(null);jsonQuiz=w("");editorOptions={language:"json",scrollBeyondLastLine:!1,lineHeight:20,fontSize:14,wordWrap:"on",wrappingIndent:"indent",theme:"customTheme",automaticLayout:!0};ngOnInit(){let i=this.route.snapshot.paramMap.get("id");if(i)this.fetchQuiz(i);else{let e=JSON.parse(JSON.stringify(te)),{_id:o}=e,t=N(e,["_id"]);this.quiz.set(t)}}generateQuiz(i,e){this.spinnerService.openGlobalSpinner(),this.quizService.generateQuiz(i,e).pipe(M(()=>{this.spinnerService.closeGlobalSpinner(),this.alertService.setMessage({message:"Quiz has been generated",type:"success"})})).subscribe(o=>{this.jsonQuiz.set(JSON.stringify(o,null,2)),this.active.set(2)})}save(){this.quiz()&&this.quizService.updateQuiz(this.quiz()).subscribe({next:i=>{this.quiz.set(i),this.alertService.setMessage({message:"Quiz has been updated",type:"success"})},error:i=>{this.alertService.setMessage({message:`Error while updating quiz:  ${i?.description}`,type:"danger"})}})}reset(){this.quizBase&&(this.quiz.set(JSON.parse(JSON.stringify(this.quizBase))),this.jsonQuiz.set(JSON.stringify(this.quizBase,null,2)))}delete(){this.quizService.deleteQuiz(this.quiz()).subscribe(()=>{this.router.navigate(["/quizzes"]),this.alertService.setMessage({message:"Quiz has been deleted",type:"success"})})}create(){this.quizService.createQuiz(this.quiz()).subscribe(()=>{this.router.navigate(["/quizzes"]),this.alertService.setMessage({message:"Quiz has been created",type:"success"})})}fetchQuiz(i){this.quizService.fetchFullQuizById(i).subscribe(e=>{e&&(this.quizBase=JSON.parse(JSON.stringify(e)),this.quiz.set(JSON.parse(JSON.stringify(e))),this.jsonQuiz.set(JSON.stringify(this.quiz(),null,2)))})}checkJson(){try{this.quiz.set(JSON.parse(this.jsonQuiz()))}catch{return this.alertService.setMessage({message:"Invalid JSON format. Please correct it.",type:"danger"}),!1}return!0}addQuestion(){this.quiz.update(i=>{let e=`q${(i?.questions.length||0)+1}`;return i?.questions.push({id:e,text:"Text sample",answers:[{id:"a1",option:"option 1",isCorrect:!0},{id:"a2",option:"option 2"},{id:"a3",option:"option 3"}]}),i})}addAnswer(i){this.quiz.update(e=>(e?.questions[i].answers.push({id:`a${e?.questions[i].answers.length+1}`,option:"new option"}),e))}deleteAnswer(i,e){this.quiz.update(o=>{let t=o?.questions[i].answers;return t?.splice(e,1),t?.forEach((r,z)=>{r.id=`a${z+1}`}),o})}deleteQuestion(i){this.quiz.update(e=>{let o=e?.questions;return o?.splice(i,1),o?.forEach((t,r)=>{t.id=`q${r+1}`}),e})}onTabChange(i){i.nextId===1&&!this.checkJson()?i.preventDefault():this.jsonQuiz.set(JSON.stringify(this.quiz(),null,2))}get isEditing(){return!!this.route.snapshot.paramMap.get("id")}static \u0275fac=function(e){return new(e||s)};static \u0275cmp=V({type:s,selectors:[["app-quiz-edit"]],decls:4,vars:2,consts:[["nav","ngbNav"],["topics",""],["nbQuestions",""],[1,"container","mt-3"],[1,"d-flex","justify-content-between","align-items-center","mb-3"],[1,"m-0"],[1,"btn","btn-primary",3,"click"],["ngbNav","",1,"nav","nav-tabs",3,"activeIdChange","navChange","activeId"],[3,"ngbNavItem"],["ngbNavLink",""],["ngbNavContent",""],[1,"mt-3",3,"ngbNavOutlet"],[1,"mb-2"],[1,"form-label"],["type","text","placeholder","Enter Quiz Title",1,"form-control",3,"ngModelChange","ngModel"],["rows","3","placeholder","Enter Explanation",1,"form-control",3,"ngModelChange","ngModel"],["type","text","placeholder","Enter Category",1,"form-control",3,"ngModelChange","ngModel"],[1,"border","p-3","mb-3"],[1,"btn","btn-sm","btn-success",3,"click"],[1,"d-flex","justify-content-end","mt-4"],[1,"btn","btn-success"],["type","text","placeholder","Enter Question Text",1,"form-control","mb-2",3,"ngModelChange","ngModel"],[1,"input-group","mb-2","align-items-center"],[1,"btn","btn-sm","btn-outline-primary",3,"click"],[1,"btn","btn-sm","btn-outline-danger","ms-2",3,"click"],["type","text","placeholder","Enter Answer Option",1,"form-control",3,"ngModelChange","ngModel"],[1,"form-check","ms-3","d-flex"],["type","checkbox",1,"form-check-input","larger-checkbox",3,"ngModelChange","id","ngModel"],[1,"form-check-label",3,"for"],[1,"btn","btn-outline-danger","me-2",3,"click"],[1,"btn","btn-success",3,"click"],[1,"editor-container"],["aria-label","JSON Quiz Editor",1,"json-editor",3,"ngModelChange","ngModel","options"],[1,"mt-3","btn","btn-primary",3,"click"],[3,"ngSubmit"],[1,"form-group"],["for","topics"],["type","text","id","topics","aria-describedby","topics","placeholder","Quiz topics","value","Java,Python",1,"form-control"],["for","nbQuestions"],["type","number","id","nbQuestions","placeholder","nbQuestions","value","5",1,"form-control"],["type","submit",1,"btn","btn-primary","mt-3"]],template:function(e,o){e&1&&(a(0,"div",3),h(1,oe,6,0,"div",4)(2,re,2,0,"h3")(3,pe,12,5),n()),e&2&&(_(),v(o.isEditing?1:2),_(2),v(o.quiz()?3:-1))},dependencies:[L,P,J,W,A,B,j,F,X,D,R,G,$,K,H,U,ee],styles:[".editor-container[_ngcontent-%COMP%]{height:calc(100vh - 300px)}.json-editor[_ngcontent-%COMP%]{height:100%;width:100%;display:block}.larger-checkbox[_ngcontent-%COMP%]{width:1.5em;height:1.5em;margin-right:.5em;cursor:pointer}.form-check-label[_ngcontent-%COMP%]{font-size:1rem;margin-left:.2em;cursor:pointer}"],changeDetection:0})};export{ie as QuizEditComponent};
