import{a as Z}from"./chunk-PN42V55X.js";import{a as I}from"./chunk-CVNQIEP5.js";import{h as $,i as G,j as R,k as H,l as K,n as U,o as X,p as Y}from"./chunk-VFGGV667.js";import{b as W,c as J,d as A,e as B,f as F,g as j,h as L,j as P}from"./chunk-2F7DOR6P.js";import{a as D}from"./chunk-UK7DRNUM.js";import{g as T,i as O}from"./chunk-HB4LE65O.js";import{Bb as g,Cb as C,Db as x,Ia as u,L as M,Pa as w,Sa as V,Xa as h,bb as f,c as N,ca as v,eb as b,gb as y,hb as Q,ib as a,ja as d,jb as n,ka as _,kb as E,lb as p,nb as m,ob as c,rb as q,wb as S,xb as l,zb as k}from"./chunk-I64YHXKP.js";var ee={_id:"%s",title:"This is an example",explanation:"Example",category:"Java",questions:[{id:"q1",text:"Quel est le type de retour de la m\xE9thode 'main' en Java ?",answers:[{id:"a1",option:"void",isCorrect:!0},{id:"a2",option:"int",isCorrect:!0},{id:"a3",option:"String"},{id:"a4",option:"boolean"}]}]};var ie=(s,i)=>i.id;function ne(s,i){if(s&1){let e=p();a(0,"div",4)(1,"h3",5),l(2,"Edit Quiz"),n(),a(3,"div")(4,"button",6),m("click",function(){d(e);let t=c();return _(t.reset())}),l(5,"Reset"),n()()()}}function oe(s,i){s&1&&(a(0,"h3"),l(1,"Create new quiz"),n())}function re(s,i){if(s&1){let e=p();a(0,"div",22)(1,"input",25),x("ngModelChange",function(t){let r=d(e).$implicit;return C(r.option,t)||(r.option=t),_(t)}),n(),a(2,"div",26)(3,"input",27),x("ngModelChange",function(t){let r=d(e).$implicit;return C(r.isCorrect,t)||(r.isCorrect=t),_(t)}),n(),a(4,"label",28),l(5," Is correct? "),n()(),a(6,"button",24),m("click",function(){let t=d(e).$index,r=c().$index,z=c(3);return _(z.deleteAnswer(r,t))}),l(7," Delete Answer "),n()()}if(s&2){let e=i.$implicit,o=i.$index,t=c().$index;u(),g("ngModel",e.option),u(2),q("id","correctAnswer",t,"-",o,""),g("ngModel",e.isCorrect),u(),q("for","correctAnswer",t,"-",o,"")}}function ae(s,i){if(s&1){let e=p();a(0,"div",17)(1,"label"),l(2),n(),a(3,"input",21),x("ngModelChange",function(t){let r=d(e).$implicit;return C(r.text,t)||(r.text=t),_(t)}),n(),y(4,re,8,8,"div",22,ie),a(6,"button",23),m("click",function(){let t=d(e).$index,r=c(3);return _(r.addAnswer(t))}),l(7," Add Answer "),n(),a(8,"button",24),m("click",function(){let t=d(e).$index,r=c(3);return _(r.deleteQuestion(t))}),l(9," Delete Question "),n()()}if(s&2){let e=i.$implicit,o=i.$index;u(2),k("Question ",o+1,""),u(),g("ngModel",e.text),u(),Q(e.answers)}}function se(s,i){if(s&1){let e=p();a(0,"button",29),m("click",function(){d(e);let t=c(3);return _(t.delete())}),l(1," Delete Quiz "),n(),a(2,"button",30),m("click",function(){d(e);let t=c(3);return _(t.save())}),l(3,"Save"),n()}}function le(s,i){if(s&1){let e=p();a(0,"button",30),m("click",function(){d(e);let t=c(3);return _(t.create())}),l(1," Create quiz "),n()}}function ce(s,i){if(s&1){let e=p();a(0,"div")(1,"div",12)(2,"label",13),l(3,"Title"),n(),a(4,"input",14),x("ngModelChange",function(t){d(e);let r=c(2);return C(r.quiz().title,t)||(r.quiz().title=t),_(t)}),n()(),a(5,"div",12)(6,"label",13),l(7,"Explanation"),n(),a(8,"textarea",15),x("ngModelChange",function(t){d(e);let r=c(2);return C(r.quiz().explanation,t)||(r.quiz().explanation=t),_(t)}),n()(),a(9,"div",12)(10,"label",13),l(11,"Category"),n(),a(12,"input",16),x("ngModelChange",function(t){d(e);let r=c(2);return C(r.quiz().category,t)||(r.quiz().category=t),_(t)}),n()()(),a(13,"h4"),l(14,"Questions"),n(),y(15,ae,10,2,"div",17,ie),a(17,"button",18),m("click",function(){d(e);let t=c(2);return _(t.addQuestion())}),l(18," Add Question "),n(),a(19,"div",19),h(20,se,4,0)(21,le,2,0,"button",20),n()}if(s&2){let e=c(2);u(4),g("ngModel",e.quiz().title),u(4),g("ngModel",e.quiz().explanation),u(4),g("ngModel",e.quiz().category),u(3),Q(e.quiz().questions),u(5),b(e.isEditing?20:21)}}function de(s,i){if(s&1){let e=p();a(0,"div",31)(1,"ngx-monaco-editor",32),x("ngModelChange",function(t){d(e);let r=c(2);return C(r.jsonQuiz,t)||(r.jsonQuiz=t),_(t)}),n()(),a(2,"button",33),m("click",function(){d(e);let t=c(2);return _(t.checkJson())}),l(3," Check JSON "),n()}if(s&2){let e=c(2);u(),g("ngModel",e.jsonQuiz),f("options",e.editorOptions)}}function _e(s,i){s&1&&(a(0,"div",41)(1,"span",42),l(2,"Loading..."),n()())}function ue(s,i){if(s&1){let e=p();a(0,"form",34),m("ngSubmit",function(){d(e);let t=S(5),r=S(10),z=c(3);return _(z.generateQuiz(t.value,r.value))}),a(1,"div",35)(2,"label",36),l(3,"This quiz is about..."),n(),E(4,"input",37,1),n(),a(6,"div",35)(7,"label",38),l(8,"Number of questions"),n(),E(9,"input",39,2),n(),a(11,"button",40),l(12," Generate "),n(),h(13,_e,3,0,"div",41),n()}if(s&2){let e=c(3);u(13),b(e.isGenerating()?13:-1)}}function me(s,i){s&1&&(a(0,"li",8)(1,"a",9),l(2,"AI generator"),n(),h(3,ue,14,1,"ng-template",10),n()),s&2&&f("ngbNavItem",3)}function pe(s,i){if(s&1){let e=p();a(0,"ul",7,0),x("activeIdChange",function(t){d(e);let r=c();return C(r.active,t)||(r.active=t),_(t)}),m("navChange",function(t){d(e);let r=c();return _(r.onTabChange(t))}),a(2,"li",8)(3,"a",9),l(4,"Form Input"),n(),h(5,ce,22,4,"ng-template",10),n(),a(6,"li",8)(7,"a",9),l(8,"JSON Editor"),n(),h(9,de,4,2,"ng-template",10),n(),h(10,me,4,1,"li",8),n(),E(11,"div",11)}if(s&2){let e=S(1),o=c();g("activeId",o.active),u(2),f("ngbNavItem",1),u(4),f("ngbNavItem",2),u(4),b(o.isEditing?-1:10),u(),f("ngbNavOutlet",e)}}var te=class s{route=v(T);router=v(O);quizService=v(D);alertService=v(I);active=w(1);isGenerating=w(!1);quiz=w(null);jsonQuiz=w("");quizBase;editorOptions={language:"json",scrollBeyondLastLine:!1,lineHeight:20,fontSize:14,wordWrap:"on",wrappingIndent:"indent",theme:"customTheme",automaticLayout:!0};ngOnInit(){let i=this.route.snapshot.paramMap.get("id");if(i)this.fetchQuiz(i);else{let e=JSON.parse(JSON.stringify(ee)),{_id:o}=e,t=N(e,["_id"]);this.quiz.set(t)}}generateQuiz(i,e){this.isGenerating.set(!0),this.quizService.generateQuiz(i,e).pipe(M(()=>{this.isGenerating.set(!1),this.alertService.setMessage({message:"Quiz has been generated",type:"success"})})).subscribe(o=>{this.jsonQuiz.set(JSON.stringify(o,null,2)),this.active.set(2)})}save(){this.quiz()&&this.quizService.updateQuiz(this.quiz()).subscribe({next:i=>{this.quiz.set(i),this.alertService.setMessage({message:"Quiz has been updated",type:"success"})},error:i=>{this.alertService.setMessage({message:`Error while updating quiz:  ${i?.description}`,type:"danger"})}})}reset(){this.quizBase&&(this.quiz.set(JSON.parse(JSON.stringify(this.quizBase))),this.jsonQuiz.set(JSON.stringify(this.quizBase,null,2)))}delete(){this.quizService.deleteQuiz(this.quiz()).subscribe(()=>{this.router.navigate(["/quizzes"]),this.alertService.setMessage({message:"Quiz has been deleted",type:"success"})})}create(){this.quizService.createQuiz(this.quiz()).subscribe(()=>{this.router.navigate(["/quizzes"]),this.alertService.setMessage({message:"Quiz has been created",type:"success"})})}fetchQuiz(i){this.quizService.fetchFullQuizById(i).subscribe(e=>{e&&(this.quizBase=JSON.parse(JSON.stringify(e)),this.quiz.set(JSON.parse(JSON.stringify(e))),this.jsonQuiz.set(JSON.stringify(this.quiz(),null,2)))})}checkJson(){try{this.quiz.set(JSON.parse(this.jsonQuiz()))}catch{return this.alertService.setMessage({message:"Invalid JSON format. Please correct it.",type:"danger"}),!1}return!0}addQuestion(){this.quiz.update(i=>{let e=`q${(i?.questions.length||0)+1}`;return i?.questions.push({id:e,text:"Text sample",answers:[{id:"a1",option:"option 1",isCorrect:!0},{id:"a2",option:"option 2"},{id:"a3",option:"option 3"}]}),i})}addAnswer(i){this.quiz.update(e=>(e?.questions[i].answers.push({id:`a${e?.questions[i].answers.length+1}`,option:"new option"}),e))}deleteAnswer(i,e){this.quiz.update(o=>{let t=o?.questions[i].answers;return t?.splice(e,1),t?.forEach((r,z)=>{r.id=`a${z+1}`}),o})}deleteQuestion(i){this.quiz.update(e=>{let o=e?.questions;return o?.splice(i,1),o?.forEach((t,r)=>{t.id=`q${r+1}`}),e})}onTabChange(i){i.nextId===1&&!this.checkJson()?i.preventDefault():this.jsonQuiz.set(JSON.stringify(this.quiz(),null,2))}get isEditing(){return!!this.route.snapshot.paramMap.get("id")}static \u0275fac=function(e){return new(e||s)};static \u0275cmp=V({type:s,selectors:[["app-quiz-edit"]],decls:4,vars:2,consts:[["nav","ngbNav"],["topics",""],["nbQuestions",""],[1,"container","mt-3"],[1,"d-flex","justify-content-between","align-items-center","mb-3"],[1,"m-0"],[1,"btn","btn-primary",3,"click"],["ngbNav","",1,"nav","nav-tabs",3,"activeIdChange","navChange","activeId"],[3,"ngbNavItem"],["ngbNavLink",""],["ngbNavContent",""],[1,"mt-3",3,"ngbNavOutlet"],[1,"mb-2"],[1,"form-label"],["type","text","placeholder","Enter Quiz Title",1,"form-control",3,"ngModelChange","ngModel"],["rows","3","placeholder","Enter Explanation",1,"form-control",3,"ngModelChange","ngModel"],["type","text","placeholder","Enter Category",1,"form-control",3,"ngModelChange","ngModel"],[1,"border","p-3","mb-3"],[1,"btn","btn-sm","btn-success",3,"click"],[1,"d-flex","justify-content-end","mt-4"],[1,"btn","btn-success"],["type","text","placeholder","Enter Question Text",1,"form-control","mb-2",3,"ngModelChange","ngModel"],[1,"input-group","mb-2","align-items-center"],[1,"btn","btn-sm","btn-outline-primary",3,"click"],[1,"btn","btn-sm","btn-outline-danger","ms-2",3,"click"],["type","text","placeholder","Enter Answer Option",1,"form-control",3,"ngModelChange","ngModel"],[1,"form-check","ms-3","d-flex"],["type","checkbox",1,"form-check-input","larger-checkbox",3,"ngModelChange","id","ngModel"],[1,"form-check-label",3,"for"],[1,"btn","btn-outline-danger","me-2",3,"click"],[1,"btn","btn-success",3,"click"],[1,"editor-container"],["aria-label","JSON Quiz Editor",1,"json-editor",3,"ngModelChange","ngModel","options"],[1,"mt-3","btn","btn-primary",3,"click"],[3,"ngSubmit"],[1,"form-group"],["for","topics"],["type","text","id","topics","aria-describedby","topics","placeholder","Quiz topics","value","Java,Python",1,"form-control"],["for","nbQuestions"],["type","number","id","nbQuestions","placeholder","nbQuestions","value","5",1,"form-control"],["type","submit",1,"btn","btn-primary","mt-3"],["role","status",1,"spinner-border","text-primary"],[1,"visually-hidden"]],template:function(e,o){e&1&&(a(0,"div",3),h(1,ne,6,0,"div",4)(2,oe,2,0,"h3")(3,pe,12,5),n()),e&2&&(u(),b(o.isEditing?1:2),u(2),b(o.quiz()?3:-1))},dependencies:[P,L,J,W,A,B,j,F,Y,$,H,R,G,U,K,X,Z],styles:[".editor-container[_ngcontent-%COMP%]{height:calc(100vh - 300px)}.json-editor[_ngcontent-%COMP%]{height:100%;width:100%;display:block}.larger-checkbox[_ngcontent-%COMP%]{width:1.5em;height:1.5em;margin-right:.5em;cursor:pointer}.form-check-label[_ngcontent-%COMP%]{font-size:1rem;margin-left:.2em;cursor:pointer}"],changeDetection:0})};export{te as QuizEditComponent};
